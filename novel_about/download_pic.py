# coding=utf-8
from bs4 import BeautifulSoup
import requests
import re

topic = 'http://www.itokoo.com/read.php?tid='


def get_url_and_password(url):
    try:
        response = requests.get(url)
    except:
        print('retry')
        print(url)
        get_url_and_password(url)
    try:
        soup = BeautifulSoup(response.content, 'html.parser')
        if soup.find('a', text='百度网盘'):
            download = str(soup.find('a', text='百度网盘')).split('href=\"')[1].split('\"')[0]
        elif soup.find('a', text='百度云网盘'):
            download = str(soup.find('a', text='百度云网盘')).split('href=\"')[1].split('\"')[0]
        else:
            print('describe is wrong', url)
            return
        ph = re.compile('密码:')
        password = str(soup.find(text=ph)).split(':')[1].strip(' ').strip('\n')
        f = open('download.txt', 'a')
        f.write(download + '   ' + password + '\n')
        print(url, download, 'write success!')
    except Exception as e:
        print(e)
        print('wrong', url)
        pass


if __name__ == '__main__':
    all_list = ['35563', '35555', '35549', '35546', '35537', '35531', '35523', '35522', '35519', '35509', '35508',
                '35501', '35500', '35494', '35492', '35491', '35485', '35484', '35483', '35478', '35477', '35453',
                '35452', '35451', '35450', '35449', '35441', '35415', '35414', '35413', '35412', '35410', '35405',
                '35380', '35379', '35378', '35377', '35376', '35375', '35357', '35348', '35345', '35335', '35328',
                '35327', '35321', '35313', '35300', '35299', '35281', '35275', '35257', '35256', '35246', '35238',
                '35231', '35214', '35213', '35200', '35192', '35186', '35177', '35169', '35163', '35146', '35145',
                '35130', '35126', '35106', '35097', '35094', '35092', '35083', '35078', '35071', '35065', '35045',
                '34981', '34957', '34950', '34933', '34914', '34901', '34895', '34891', '34880', '34873', '34858',
                '34857', '34843', '34837', '34836', '34835', '34819', '34814', '34809', '34806', '34790', '34789',
                '34788', '34777', '34772', '34769', '34747', '34508', '34501', '34470', '34460', '34453', '34447',
                '34437', '34436', '34435', '34397', '34391', '34375', '34365', '34360', '34334', '34323', '34316',
                '34306', '34295', '34272', '34261', '34255', '34213', '34208', '34200', '34188', '34182', '34174',
                '34167', '34164', '34150', '34142', '34137', '34119', '34106', '34100', '34077', '34068', '34042',
                '34030', '34029', '33985', '33978', '33971', '33958', '33930', '33906', '33899', '33848', '33831',
                '33823', '33813', '33800', '33780', '33774', '33741', '33731', '33723', '33706', '33695', '33687',
                '33678', '33653', '33632', '33608', '33587', '33533', '33522', '33515', '33505', '33484', '33471',
                '33445', '33427', '33417', '33406', '33388', '33368', '33339', '33301', '33135', '33134', '33133',
                '33132', '33136', '33131', '33130', '33129', '33128', '33110', '33078', '33057', '33037', '33029',
                '33017', '33011', '33010', '33005', '32991', '32971', '32950', '32939', '32933', '32923', '32912',
                '32907', '32899', '32890', '32875', '32869', '32856', '32826', '32823', '32811', '32806', '32793',
                '32787', '32778', '32769', '32763', '32760', '32746', '32743', '32730', '32714', '32712', '32699',
                '32679', '32669', '32394', '32634', '32627', '32620', '32616', '32578', '32567', '32515', '32496',
                '32495', '32494', '32485', '32483', '32430', '32423', '32414', '32409', '32401', '32392', '32381',
                '32361', '32344', '32303', '32262', '32261', '32260', '32259', '32258', '32257', '32256', '32240',
                '32227', '32224', '32221', '32215', '32198', '32192', '32191', '32190', '32189', '32160', '32155',
                '32154', '32153', '32152', '32150', '32143', '32085', '32070', '32013', '32003', '31988', '31985',
                '31984', '31983', '31947', '31941', '31935', '31934', '31933', '31925', '31901', '31895', '31875',
                '31865', '31844', '31837', '31836', '31835', '31831', '31827', '31822', '31816', '31795', '31769',
                '31763', '31758', '31757', '31756', '31755', '31728', '31726', '31725', '31724', '31723', '31689',
                '31688', '31687', '31627', '31611', '31590', '31565', '31547', '31539', '31510', '31509', '31491',
                '31490', '31489', '31488', '31487', '31460', '31446', '31445', '31440', '31426', '31402', '31398',
                '31384', '31336', '31332', '31331', '31330', '31329', '31328', '31323', '31318', '31309', '31298',
                '31286', '31277', '31255', '31224', '31219', '31213', '31141', '31134', '31128', '31106', '31088',
                '31059', '31055', '31022', '31002', '30937', '30900', '30881', '30858', '30823', '30682', '30660',
                '30619', '30609', '30596', '30592', '30563', '30543', '30494', '30467', '30446', '30404', '30399',
                '30386', '30370', '30369', '30306', '30305', '30304', '30303', '30302', '30301', '30300', '30299',
                '30298', '30297', '30296', '30295', '30294', '30293', '30292', '30291', '30290', '30289', '30288',
                '30287', '30279', '30278', '30277', '30276', '30275', '30274', '30273', '30272', '30271', '30270',
                '30264', '30263', '30262', '30261', '30260', '30259', '30258', '30257', '30256', '30255', '30241',
                '30240', '30239', '30238', '30237', '30236', '30235', '30234', '30233', '30232', '30230', '30229',
                '30228', '30227', '30226', '30225', '30224', '30223', '30222', '30221', '30220', '30219', '30218',
                '30217', '30216', '30215', '30214', '30213', '30189', '30180', '30141', '30140', '30139', '30138',
                '30137', '30136', '30135', '30134', '30133', '30132', '30114', '30113', '30112', '30111', '30110',
                '30109', '30108', '30107', '30055', '30054', '30053', '30052', '30051', '30050', '30049', '30048',
                '30047', '30046', '30045', '30044', '30035', '30034', '30033', '30032', '30031', '30030', '30029',
                '30028', '30027', '30026', '30016', '30015', '30014', '30013', '30012', '30011', '30010', '30009',
                '30008', '30007', '29995', '29994', '29993', '29992', '29991', '29990', '29989', '29988', '29987',
                '29986', '29942', '29941', '29940', '29939', '29938', '29937', '29936', '29935', '29934', '29933',
                '29923', '29922', '29921', '29920', '29919', '29918', '29917', '29916', '29915', '29914', '29913',
                '29903', '29902', '29901', '29900', '29899', '29898', '29897', '29896', '29895', '29894', '29885',
                '29884', '29883', '29882', '29782', '29767', '29697', '29685', '29611', '29558', '29545', '29501',
                '29492', '29486', '29465', '29453', '29447', '29404', '29397', '29368', '29345', '29338', '29309',
                '29302', '29272', '29266', '29253', '29243', '29235', '29222', '29216', '29208', '29201', '29193',
                '29167', '29154', '29134', '29126', '29118', '29095', '29087', '29056', '29040', '29029', '29012',
                '28973', '28950', '28939', '28930', '28920', '28909', '28814', '28788', '28740', '28724', '28696',
                '28687', '28683', '28675', '28670', '28663', '28652', '28637', '28631', '28619', '28609', '28601',
                '28594', '28581', '28563', '28549', '28537', '28517', '28512', '28505', '28500', '28489', '28477',
                '28449', '28429', '28396', '28366', '28336', '28316', '28282', '28201', '28125', '28067', '28029',
                '27956', '27938', '27879', '27809', '27710', '27743', '27683', '27594', '27579', '27540', '27503',
                '27481', '27434', '27403', '27336', '27304', '27263', '27179', '27131', '27116', '27080', '27006',
                '26918', '26848', '26733', '26662', '26628', '26602', '26584', '26544', '26515', '26483', '26455',
                '26393', '26343', '26309', '26299', '26286', '26221', '26178', '26135', '26059', '26024', '25389',
                '25367', '25358', '25343', '25333', '25316', '25305', '25293', '25280', '25268', '25258', '25227',
                '25211', '25181', '25146', '25139', '25129', '25123', '25113', '25104', '25069', '25059', '25043',
                '25021', '25007', '24996', '24989', '24978', '24964', '24932', '24894', '24810', '24762', '24747',
                '24738', '24730', '24708', '24688', '24676', '24670', '24653', '24647', '24640', '24627', '24617',
                '24607', '23518', '24599', '24591', '24575', '24571', '24565', '24550', '23517', '24540', '24530',
                '24517', '24512', '24501', '24494', '24482', '24470', '24464', '24453', '23550', '23549', '23548',
                '23547', '23156', '23155', '23154', '23153', '23152', '23151', '23150', '23149', '23148', '23147',
                '22975', '22974', '22960', '22959', '22958', '22957', '22956', '22955', '22954', '22953', '22818',
                '22810', '22809', '22792', '22791', '22758', '22757', '22756', '22755', '22740', '22733', '22730',
                '22729', '22728', '22727', '22726', '22704', '22702', '22699', '22698', '22693', '22691', '22665',
                '22601', '22593', '22582', '22524', '22513', '22498', '22469', '22467', '22445', '22425', '22417',
                '22401', '22392', '22379', '22367', '22359', '22358', '22338', '22331', '22232', '22189', '22176',
                '22172', '22153', '22129', '22127', '22109', '22103', '22080', '22026', '21991', '21978', '21900',
                '21899', '21884', '21879', '21873', '21854', '21851', '21831', '21816', '21805', '21804', '21772',
                '21756', '21754', '21745', '21689', '21674', '21665', '21652', '21641', '21634', '21603', '21582',
                '21573', '21566', '21508', '21494', '21470', '21469', '21413', '21412', '21402', '21385', '21384',
                '21369', '21364', '21363', '21356', '21347', '21277', '21239', '21230', '21221', '21220', '21218',
                '21219', '21217', '21215', '21214', '21207', '21206', '21205', '21204', '21203', '21202', '21201',
                '21199', '21198', '21178', '21177', '21176', '21175', '21174', '21173', '21172', '21171', '21170',
                '21168', '21167', '21166', '21164', '21162', '21161', '21160', '21137', '21136', '21135', '21134',
                '21132', '21117', '21116', '21115', '21113', '21111', '21102', '21101', '21100', '21099', '21098',
                '21094', '21093', '21092', '20999', '20998', '20997', '20990', '20989', '20988', '20969', '20968',
                '20967', '20966', '20965', '20963', '35406', '35393', '35340', '35333', '35284', '35262', '35222',
                '35202', '35156', '35135', '35073', '35069', '34968', '34923', '34917', '34881', '34854', '34846',
                '34797', '34761', '34477', '34457', '34433', '34341', '34280', '34221', '34186', '34169', '34151',
                '34140', '34109', '34085', '34002', '33962', '33826', '33807', '33747', '33709', '33654', '33598',
                '33572', '33514', '33460', '33420', '33292', '33261', '33219', '33178', '33124', '33079', '33018',
                '32964', '32940', '32867', '32835', '32834', '32833', '32790', '32759', '32736', '32665', '32589',
                '32540', '32482', '32458', '32452', '32438', '32169', '32167', '32166', '32165', '32164', '32163',
                '32162', '32126', '32108', '32047', '32016', '31986', '31946', '31843', '31839', '31838', '31806',
                '31804', '31803', '31798', '31782', '31777', '31679', '31678', '31677', '31676', '31626', '31619',
                '31494', '31467', '31418', '31416', '31403', '31390', '31361', '31240', '31208', '31151', '31140',
                '31089', '31060', '30919', '30915', '30914', '30913', '30912', '30910', '30909', '30908', '30907',
                '30906', '30905', '30895', '30894', '30893', '30892', '30891', '30890', '30888', '30887', '30886',
                '30884', '30872', '30871', '30870', '30869', '30868', '30867', '30866', '30865', '30864', '30862',
                '30850', '30849', '30847', '30846', '30844', '30843', '30842', '30841', '30840', '30839', '30838',
                '30837', '30835', '30834', '30833', '30832', '30830', '30815', '30814', '30813', '30812', '30811',
                '30810', '30809', '30808', '30807', '30806', '30805', '30804', '30803', '30802', '30800', '30799',
                '30798', '30797', '30640', '30639', '30637', '30636', '30635', '30602', '30601', '30600', '30599',
                '30598', '30586', '30584', '30583', '30582', '30580', '30558', '30557', '30556', '30555', '30554',
                '30538', '30537', '30536', '30535', '30506', '30252', '26268', '26267', '26266', '26265', '26264',
                '26263', '26262', '26261', '26260']
    for item in all_list:
        true_url = topic + str(item)
        get_url_and_password(true_url)
    print('its end')
